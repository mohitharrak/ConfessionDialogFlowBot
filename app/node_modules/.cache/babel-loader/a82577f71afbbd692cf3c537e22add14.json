{"ast":null,"code":"import { DayOfWeek, MonthOfYear, FirstWeekOfYear, DateRangeType } from '../dateValues/DateValues';\nimport TimeConstants from '../dateValues/TimeConstants';\nimport { assertNever } from '../../Utilities';\n/**\r\n * Returns a date offset from the given date by the specified number of days.\r\n * @param {Date} date - The origin date\r\n * @param {number} days - The number of days to offset. 'days' can be negative.\r\n * @return {Date} A new Date object offset from the origin date by the given number of days\r\n */\n\nexport function addDays(date, days) {\n  var result = new Date(date.getTime());\n  result.setDate(result.getDate() + days);\n  return result;\n}\n/**\r\n * Returns a date offset from the given date by the specified number of weeks.\r\n * @param {Date} date - The origin date\r\n * @param {number} weeks - The number of weeks to offset. 'weeks' can be negative.\r\n * @return {Date} A new Date object offset from the origin date by the given number of weeks\r\n */\n\nexport function addWeeks(date, weeks) {\n  return addDays(date, weeks * TimeConstants.DaysInOneWeek);\n}\n/**\r\n * Returns a date offset from the given date by the specified number of months.\r\n * The method tries to preserve the day-of-month; however, if the new month does not have enough days\r\n * to contain the original day-of-month, we'll use the last day of the new month.\r\n * @param {Date} date - The origin date\r\n * @param {number} months - The number of months to offset. 'months' can be negative.\r\n * @return {Date} A new Date object offset from the origin date by the given number of months\r\n */\n\nexport function addMonths(date, months) {\n  var result = new Date(date.getTime());\n  var newMonth = result.getMonth() + months;\n  result.setMonth(newMonth); // We want to maintain the same day-of-month, but that may not be possible if the new month doesn't have enough days.\n  // Loop until we back up to a day the new month has.\n  // (Weird modulo math is due to Javascript's treatment of negative numbers in modulo)\n\n  if (result.getMonth() !== (newMonth % TimeConstants.MonthInOneYear + TimeConstants.MonthInOneYear) % TimeConstants.MonthInOneYear) {\n    result = addDays(result, -result.getDate());\n  }\n\n  return result;\n}\n/**\r\n * Returns a date offset from the given date by the specified number of years.\r\n * The method tries to preserve the day-of-month; however, if the new month does not have enough days\r\n * to contain the original day-of-month, we'll use the last day of the new month.\r\n * @param {Date} date - The origin date\r\n * @param {number} years - The number of years to offset. 'years' can be negative.\r\n * @return {Date} A new Date object offset from the origin date by the given number of years\r\n */\n\nexport function addYears(date, years) {\n  var result = new Date(date.getTime());\n  result.setFullYear(date.getFullYear() + years); // We want to maintain the same day-of-month, but that may not be possible if the new month doesn't have enough days.\n  // Loop until we back up to a day the new month has.\n  // (Weird modulo math is due to Javascript's treatment of negative numbers in modulo)\n\n  if (result.getMonth() !== (date.getMonth() % TimeConstants.MonthInOneYear + TimeConstants.MonthInOneYear) % TimeConstants.MonthInOneYear) {\n    result = addDays(result, -result.getDate());\n  }\n\n  return result;\n}\n/**\r\n * Returns a date that is the first day of the month of the provided date.\r\n * @param {Date} date - The origin date\r\n * @return {Date} A new Date object with the day set to the first day of the month.\r\n */\n\nexport function getMonthStart(date) {\n  return new Date(date.getFullYear(), date.getMonth(), 1, 0, 0, 0, 0);\n}\n/**\r\n * Returns a date that is the last day of the month of the provided date.\r\n * @param {Date} date - The origin date\r\n * @return {Date} A new Date object with the day set to the last day of the month.\r\n */\n\nexport function getMonthEnd(date) {\n  return new Date(date.getFullYear(), date.getMonth() + 1, 0, 0, 0, 0, 0);\n}\n/**\r\n * Returns a date that is the first day of the year of the provided date.\r\n * @param {Date} date - The origin date\r\n * @return {Date} A new Date object with the day set to the first day of the year.\r\n */\n\nexport function getYearStart(date) {\n  return new Date(date.getFullYear(), 0, 1, 0, 0, 0, 0);\n}\n/**\r\n * Returns a date that is the last day of the year of the provided date.\r\n * @param {Date} date - The origin date\r\n * @return {Date} A new Date object with the day set to the last day of the year.\r\n */\n\nexport function getYearEnd(date) {\n  return new Date(date.getFullYear() + 1, 0, 0, 0, 0, 0, 0);\n}\n/**\r\n * Returns a date that is a copy of the given date, aside from the month changing to the given month.\r\n *  The method tries to preserve the day-of-month; however, if the new month does not have enough days\r\n * to contain the original day-of-month, we'll use the last day of the new month.\r\n * @param {Date} date - The origin date\r\n * @param {number} month - The 0-based index of the month to set on the date.\r\n * @return {Date} A new Date object with the given month set.\r\n */\n\nexport function setMonth(date, month) {\n  return addMonths(date, month - date.getMonth());\n}\n/**\r\n * Compares two dates, and returns true if the two dates (not accounting for time-of-day) are equal.\r\n * @return {boolean} True if the two dates represent the same date (regardless of time-of-day), false otherwise.\r\n */\n\nexport function compareDates(date1, date2) {\n  if (!date1 && !date2) {\n    return true;\n  } else if (!date1 || !date2) {\n    return false;\n  } else {\n    return date1.getFullYear() === date2.getFullYear() && date1.getMonth() === date2.getMonth() && date1.getDate() === date2.getDate();\n  }\n}\n/**\r\n * Compare the date parts of two dates\r\n * @param {Date} date1 - The first date to compare\r\n * @param {Date} date2 - The second date to compare\r\n * @returns {Number} A negative value if date1 is earlier than date2, 0 if the dates are equal, or a positive value\r\n * if date1 is later than date2.\r\n */\n\nexport function compareDatePart(date1, date2) {\n  return getDatePartHashValue(date1) - getDatePartHashValue(date2);\n}\n/**\r\n * Gets the date range array including the specified date. The date range array is calculated as the list\r\n * of dates accounting for the specified first day of the week and date range type.\r\n * @param {Date} date - The input date\r\n * @param {DateRangeType} dateRangeType - The desired date range type, i.e., day, week, month, etc.\r\n * @param {DayOfWeek} firstDayOfWeek - The first day of the week.\r\n * @param {DayOfWeek[]} workWeekDays - The allowed days in work week. If not provided, assumes all days are allowed.\r\n * @returns {Date[]} An array of dates representing the date range containing the specified date.\r\n */\n\nexport function getDateRangeArray(date, dateRangeType, firstDayOfWeek, workWeekDays) {\n  var datesArray = new Array();\n  var startDate;\n  var endDate = null;\n\n  if (!workWeekDays) {\n    workWeekDays = [DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday];\n  }\n\n  switch (dateRangeType) {\n    case DateRangeType.Day:\n      startDate = getDatePart(date);\n      endDate = addDays(startDate, 1);\n      break;\n\n    case DateRangeType.Week:\n    case DateRangeType.WorkWeek:\n      startDate = getStartDateOfWeek(getDatePart(date), firstDayOfWeek);\n      endDate = addDays(startDate, TimeConstants.DaysInOneWeek);\n      break;\n\n    case DateRangeType.Month:\n      startDate = new Date(date.getFullYear(), date.getMonth(), 1);\n      endDate = addMonths(startDate, 1);\n      break;\n\n    default:\n      return assertNever(dateRangeType);\n  } // Populate the dates array with the dates in range\n\n\n  var nextDate = startDate;\n\n  do {\n    if (dateRangeType !== DateRangeType.WorkWeek) {\n      // push all days not in work week view\n      datesArray.push(nextDate);\n    } else if (workWeekDays.includes(nextDate.getDay())) {\n      datesArray.push(nextDate);\n    }\n\n    nextDate = addDays(nextDate, 1);\n  } while (!compareDates(nextDate, endDate));\n\n  return datesArray;\n}\n/**\r\n * Checks whether the specified date is in the given date range.\r\n * @param {Date} date - The origin date\r\n * @param {Date[]} dateRange - An array of dates to do the lookup on\r\n * @returns {bool} True if the date matches one of the dates in the specified array, false otherwise.\r\n */\n\nexport function isInDateRangeArray(date, dateRange) {\n  for (var _i = 0, dateRange_1 = dateRange; _i < dateRange_1.length; _i++) {\n    var dateInRange = dateRange_1[_i];\n\n    if (compareDates(date, dateInRange)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\r\n * Returns the week number for a date.\r\n * Week numbers are 1 - 52 (53) in a year\r\n * @param {navigatedDate} Date - A date to find the week number for.\r\n * @param {firstDayOfWeek} DayOfWeek - The first day of the week (0-6, Sunday = 0)\r\n * @param {firstWeekOfYear} FirstWeekOfYear - The first week of the year (1-2)\r\n * @return {weeksArray} The weeks number array for the current month.\r\n */\n\nexport function getWeekNumbersInMonth(weeksInMonth, firstDayOfWeek, firstWeekOfYear, navigatedDate) {\n  var selectedYear = navigatedDate.getFullYear();\n  var selectedMonth = navigatedDate.getMonth();\n  var dayOfMonth = 1;\n  var fistDayOfMonth = new Date(selectedYear, selectedMonth, dayOfMonth);\n  var endOfFirstWeek = dayOfMonth + (firstDayOfWeek + TimeConstants.DaysInOneWeek - 1) - adjustWeekDay(firstDayOfWeek, fistDayOfMonth.getDay());\n  var endOfWeekRange = new Date(selectedYear, selectedMonth, endOfFirstWeek);\n  dayOfMonth = endOfWeekRange.getDate();\n  var weeksArray = [];\n\n  for (var i = 0; i < weeksInMonth; i++) {\n    // Get week number for end of week\n    weeksArray.push(getWeekNumber(endOfWeekRange, firstDayOfWeek, firstWeekOfYear));\n    dayOfMonth += TimeConstants.DaysInOneWeek;\n    endOfWeekRange = new Date(selectedYear, selectedMonth, dayOfMonth);\n  }\n\n  return weeksArray;\n}\n/**\r\n * Returns the week number for a date.\r\n * Week numbers are 1 - 52 (53) in a year\r\n * @param {Date} date - A date to find the week number for.\r\n * @param {DayOfWeek} firstDayOfWeek - The first day of the week (0-6, Sunday = 0)\r\n * @param {firstWeekOfYear} firstWeekOfYear - The first week of the year (1-2)\r\n * @return {Number} The week's number in the year.\r\n */\n\nexport function getWeekNumber(date, firstDayOfWeek, firstWeekOfYear) {\n  // First four-day week of the year - minumum days count\n  var fourDayWeek = 4;\n\n  switch (firstWeekOfYear) {\n    case FirstWeekOfYear.FirstFullWeek:\n      return getWeekOfYearFullDays(date, firstDayOfWeek, TimeConstants.DaysInOneWeek);\n\n    case FirstWeekOfYear.FirstFourDayWeek:\n      return getWeekOfYearFullDays(date, firstDayOfWeek, fourDayWeek);\n\n    default:\n      return getFirstDayWeekOfYear(date, firstDayOfWeek);\n  }\n}\n/**\r\n * Gets a new date with the time portion zeroed out, i.e., set to midnight\r\n * @param {Date} date - The origin date\r\n * @returns {Date} A new date with the time set to midnight\r\n */\n\nfunction getDatePart(date) {\n  return new Date(date.getFullYear(), date.getMonth(), date.getDate());\n}\n/**\r\n * Gets the date for the first day of the week based on the given date assuming\r\n * the specified first day of the week.\r\n * @param {Date} date - The date to find the beginning of the week date for.\r\n * @return {Date} A new date object representing the first day of the week containing the input date.\r\n */\n\n\nfunction getStartDateOfWeek(date, firstDayOfWeek) {\n  var daysOffset = firstDayOfWeek - date.getDay();\n\n  if (daysOffset > 0) {\n    // If first day of week is > date, go 1 week back, to ensure resulting date is in the past.\n    daysOffset -= TimeConstants.DaysInOneWeek;\n  }\n\n  return addDays(date, daysOffset);\n}\n/**\r\n * Helper function to assist in date comparisons\r\n */\n\n\nfunction getDatePartHashValue(date) {\n  // Generate date hash value created as sum of Date (up to 31 = 5 bits), Month (up to 11 = 4 bits) and Year.\n\n  /* tslint:disable:no-bitwise */\n  return date.getDate() + (date.getMonth() << 5) + (date.getFullYear() << 9);\n  /* tslint:enable:no-bitwise */\n}\n/**\r\n * Helper function for getWeekNumber.\r\n * Returns week number for a date\r\n * @param {date} Date - current selected date.\r\n * @param {firstDayOfWeek} DayOfWeek - The first day of week (0-6, Sunday = 0)\r\n * @param {numberOfFullDays} number - week settings.\r\n * @return {Number} The week's number in the year.\r\n */\n\n\nfunction getWeekOfYearFullDays(date, firstDayOfWeek, numberOfFullDays) {\n  var dayOfYear = getDayOfYear(date) - 1;\n  var num = date.getDay() - dayOfYear % TimeConstants.DaysInOneWeek;\n  var lastDayOfPrevYear = new Date(date.getFullYear() - 1, MonthOfYear.December, 31);\n  var daysInYear = getDayOfYear(lastDayOfPrevYear) - 1;\n  var num2 = (firstDayOfWeek - num + 2 * TimeConstants.DaysInOneWeek) % TimeConstants.DaysInOneWeek;\n\n  if (num2 !== 0 && num2 >= numberOfFullDays) {\n    num2 -= TimeConstants.DaysInOneWeek;\n  }\n\n  var num3 = dayOfYear - num2;\n\n  if (num3 < 0) {\n    num -= daysInYear % TimeConstants.DaysInOneWeek;\n    num2 = (firstDayOfWeek - num + 2 * TimeConstants.DaysInOneWeek) % TimeConstants.DaysInOneWeek;\n\n    if (num2 !== 0 && num2 + 1 >= numberOfFullDays) {\n      num2 -= TimeConstants.DaysInOneWeek;\n    }\n\n    num3 = daysInYear - num2;\n  }\n\n  return Math.floor(num3 / TimeConstants.DaysInOneWeek + 1);\n}\n/**\r\n * Helper function for getWeekNumber.\r\n * Returns week number for a date\r\n * @param {date} Date - current selected date.\r\n * @param {firstDayOfWeek} DayOfWeek - The first day of week (0-6, Sunday = 0)\r\n * @return {Number} The week's number in the year.\r\n */\n\n\nfunction getFirstDayWeekOfYear(date, firstDayOfWeek) {\n  var num = getDayOfYear(date) - 1;\n  var num2 = date.getDay() - num % TimeConstants.DaysInOneWeek;\n  var num3 = (num2 - firstDayOfWeek + 2 * TimeConstants.DaysInOneWeek) % TimeConstants.DaysInOneWeek;\n  return Math.floor((num + num3) / TimeConstants.DaysInOneWeek + 1);\n}\n/**\r\n * Helper function for getWeekNumber.\r\n * Returns adjusted week day number when firstDayOfWeek is other than Sunday\r\n * For Week Day Number comparison checks\r\n * @param {firstDayOfWeek} DayOfWeek - The first day of week (0-6, Sunday = 0)\r\n * @param {dateWeekDay} DayOfWeek - shifts number forward to 1 week in case passed as true\r\n * @return {DayOfWeek} The day of week adjusted to firstDayOfWeek. E.g. when FirstDyOfWeek is Monday (1), Sunday becomes = 7 (7 > 1).\r\n */\n\n\nfunction adjustWeekDay(firstDayOfWeek, dateWeekDay) {\n  return firstDayOfWeek !== DayOfWeek.Sunday && dateWeekDay < firstDayOfWeek ? dateWeekDay + TimeConstants.DaysInOneWeek : dateWeekDay;\n}\n/**\r\n * Returns the day number for a date in a year\r\n * The number of days since January 1st in the particular year.\r\n * @param {Date} date - A date to find the day number for.\r\n * @return {Number} The day's number in the year.\r\n */\n\n\nfunction getDayOfYear(date) {\n  var month = date.getMonth();\n  var year = date.getFullYear();\n  var daysUntilDate = 0;\n\n  for (var i = 0; i < month; i++) {\n    daysUntilDate += daysInMonth(i + 1, year);\n  }\n\n  daysUntilDate += date.getDate();\n  return daysUntilDate;\n}\n/**\r\n * Returns the number of days in the month\r\n * @param {number} month - The month number to target (months 1-12).\r\n * @param {number} year - The year to target.\r\n * @return {Number} The number of days in the month.\r\n */\n\n\nfunction daysInMonth(month, year) {\n  return new Date(year, month, 0).getDate();\n}","map":null,"metadata":{},"sourceType":"module"}