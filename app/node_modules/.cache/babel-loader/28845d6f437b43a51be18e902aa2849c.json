{"ast":null,"code":"import * as tslib_1 from \"tslib\";\nimport * as React from 'react';\nimport { BaseComponent, classNamesFunction, css, format, getId } from '../../Utilities';\nimport { Icon } from '../../Icon';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport { RatingSize } from './Rating.types';\nvar getClassNames = classNamesFunction();\n\nvar RatingStar = function RatingStar(props) {\n  var icon = props.icon || 'FavoriteStarFill';\n  return React.createElement(\"div\", {\n    className: props.classNames.ratingStar,\n    key: props.id\n  }, React.createElement(Icon, {\n    className: props.classNames.ratingStarBack,\n    iconName: icon\n  }), !props.disabled && React.createElement(Icon, {\n    className: props.classNames.ratingStarFront,\n    iconName: icon,\n    style: {\n      width: props.fillPercentage + '%'\n    }\n  }));\n};\n\nvar RatingBase =\n/** @class */\nfunction (_super) {\n  tslib_1.__extends(RatingBase, _super);\n\n  function RatingBase(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this._warnDeprecations({\n      onChanged: 'onChange'\n    });\n\n    _this._id = getId('Rating');\n    _this._min = _this.props.allowZeroStars ? 0 : 1;\n\n    if (_this.props.min !== undefined && _this.props.min !== 1) {\n      _this._min = _this.props.min;\n    }\n\n    _this._labelId = getId('RatingLabel');\n    _this.state = {\n      rating: _this._getInitialValue(props)\n    };\n    return _this;\n  }\n\n  RatingBase.prototype.componentWillReceiveProps = function (nextProps) {\n    if (typeof nextProps.rating !== 'undefined' && nextProps.rating !== this.state.rating) {\n      this.setState({\n        rating: this._getClampedRating(nextProps.rating)\n      });\n    }\n  };\n\n  RatingBase.prototype.render = function () {\n    var id = this._id;\n    var stars = [];\n    var starIds = [];\n    var _a = this.props,\n        disabled = _a.disabled,\n        getAriaLabel = _a.getAriaLabel,\n        styles = _a.styles,\n        max = _a.max,\n        rating = _a.rating,\n        readOnly = _a.readOnly,\n        size = _a.size,\n        theme = _a.theme,\n        icon = _a.icon,\n        _b = _a.unselectedIcon,\n        unselectedIcon = _b === void 0 ? icon : _b;\n    this._classNames = getClassNames(styles, {\n      disabled: disabled,\n      readOnly: readOnly,\n      theme: theme\n    });\n\n    for (var i = this._min; i <= max; i++) {\n      if (i !== 0) {\n        var fillPercentage = this._getFillingPercentage(i);\n\n        var ratingStarProps = {\n          fillPercentage: fillPercentage,\n          disabled: disabled ? true : false,\n          readOnly: readOnly ? true : false,\n          classNames: this._classNames,\n          icon: fillPercentage > 0 ? icon : unselectedIcon\n        };\n        starIds.push(this._getStarId(i - 1));\n        stars.push(React.createElement(\"button\", tslib_1.__assign({\n          className: css(this._classNames.ratingButton, (_c = {}, _c[this._classNames.ratingStarIsLarge] = size === RatingSize.Large, _c[this._classNames.ratingStarIsSmall] = size !== RatingSize.Large, _c)),\n          id: starIds[i - 1],\n          key: i\n        }, i === Math.ceil(this.state.rating) ? {\n          'data-is-current': true\n        } : {}, {\n          onFocus: this._onFocus.bind(this, i),\n          onClick: this._onFocus.bind(this, i),\n          disabled: disabled || readOnly ? true : false,\n          role: \"presentation\",\n          type: \"button\"\n        }), this._getLabel(i), React.createElement(RatingStar, tslib_1.__assign({\n          key: i + 'rating'\n        }, ratingStarProps))));\n      }\n    }\n\n    return React.createElement(\"div\", {\n      className: css('ms-Rating-star', this._classNames.root, (_d = {}, _d[this._classNames.rootIsLarge] = size === RatingSize.Large, _d[this._classNames.rootIsSmall] = size !== RatingSize.Large, _d)),\n      \"aria-label\": getAriaLabel ? getAriaLabel(this.state.rating ? this.state.rating : 0, this.props.max) : '',\n      id: id\n    }, React.createElement(FocusZone, {\n      direction: FocusZoneDirection.horizontal,\n      tabIndex: readOnly ? 0 : -1,\n      className: css(this._classNames.ratingFocusZone, (_e = {}, _e[this._classNames.rootIsLarge] = size === RatingSize.Large, _e[this._classNames.rootIsSmall] = size !== RatingSize.Large, _e)),\n      \"data-is-focusable\": readOnly ? true : false,\n      defaultActiveElement: rating ? starIds[rating - 1] && '#' + starIds[rating - 1] : undefined\n    }, stars));\n\n    var _c, _d, _e;\n  };\n\n  RatingBase.prototype._getStarId = function (index) {\n    return this._id + '-star-' + index;\n  };\n\n  RatingBase.prototype._onFocus = function (value, ev) {\n    if (this.state.rating !== value) {\n      this.setState({\n        rating: value\n      });\n      var _a = this.props,\n          onChange = _a.onChange,\n          onChanged = _a.onChanged;\n\n      if (onChange) {\n        onChange(ev, value);\n      }\n\n      if (onChanged) {\n        onChanged(value);\n      }\n    }\n  };\n\n  RatingBase.prototype._getLabel = function (rating) {\n    var text = this.props.ariaLabelFormat || '';\n    return React.createElement(\"span\", {\n      id: this._labelId + \"-\" + rating,\n      className: this._classNames.labelText\n    }, format(text, rating, this.props.max));\n  };\n\n  RatingBase.prototype._getInitialValue = function (props) {\n    if (typeof props.rating === 'undefined') {\n      return this._min;\n    }\n\n    if (props.rating === null) {\n      return undefined;\n    }\n\n    return this._getClampedRating(props.rating);\n  };\n\n  RatingBase.prototype._getClampedRating = function (rating) {\n    return Math.min(Math.max(rating, this._min), this.props.max);\n  };\n\n  RatingBase.prototype._getFillingPercentage = function (starPosition) {\n    var ceilValue = Math.ceil(this.state.rating);\n    var fillPercentage = 100;\n\n    if (starPosition === this.state.rating) {\n      fillPercentage = 100;\n    } else if (starPosition === ceilValue) {\n      fillPercentage = 100 * (this.state.rating % 1);\n    } else if (starPosition > ceilValue) {\n      fillPercentage = 0;\n    }\n\n    return fillPercentage;\n  };\n\n  RatingBase.defaultProps = {\n    min: 1,\n    max: 5\n  };\n  return RatingBase;\n}(BaseComponent);\n\nexport { RatingBase };","map":null,"metadata":{},"sourceType":"module"}